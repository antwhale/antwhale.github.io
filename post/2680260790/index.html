<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta name="generator" content="Hexo 5.4.0">
  <meta charset="utf-8">
  

  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Gson简易指南 - CAYZLH</title>

  
  <meta name="description" content="Gson 是用于将 Java 对象与 JSON格式字符串数据相互转换的 Java 库。">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="CAYZLH" type="application/atom+xml">
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  
    
      <meta name="msapplication-TileColor" content="#2d89ef">
    
      <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml">
    
      <meta name="theme-color" content="#ffffff">
    
      <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/cayzlh/psychic-potato@master/logo/favicon.ico">
    
      <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/cayzlh/psychic-potato@master/logo/favicon-192x192.png" sizes="192x192">
    
      <link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/cayzlh/psychic-potato@master/logo/apple-touch-icon.png">
    
  
</head>

<body>
  


  <div class="l_body" id="start">
    <aside class="l_left">
    

<header class="header">
  <div class="logo-wrap">
  
    <a class="avatar" href="/">
      
        <img no-lazy class="bg" src="https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.2/avatar/round/rainbow64@3x.webp" onerror="javascript:this.classList.add('error');this.src='https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/image/2659360.svg';">
      
      <img no-lazy class="avatar" src="https://cdn.jsdelivr.net/gh/cayzlh/psychic-potato@master/image/IMG_4207.JPG" onerror="javascript:this.classList.add('error');this.src='https://cdn.jsdelivr.net/gh/cdn-x/placeholder@1.0.1/image/2659360.svg';">
    </a>
  
  
    <a class="title" href="/">
      CAYZLH
    </a>
  
</div>

  <nav class="menu dis-select"><a class="nav-item active" href="/">文章</a><a class="nav-item" href="/wiki/">文档</a><a class="nav-item" href="/talking/">动态</a></nav>
</header>

<div class="widgets">
  
    
      
      
<div class="widget-wrap" id="toc"><div class="widget-header h4 dis-select"><span class="name">本文目录</span></div><div class="widget-body fs14 post"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Gson%E7%AE%80%E4%BB%8B"><span class="toc-text">Gson简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gson%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-text">Gson基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">Java序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">简单对象的序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JosnObject-%E7%94%9F%E6%88%90-JSON"><span class="toc-text">JosnObject 生成 JSON</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">JSON 反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">简单对象的反序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-Map"><span class="toc-text">反序列化 Map</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON-%E4%B8%8E-Array%EF%BC%8CList-%E8%BD%AC%E6%8D%A2"><span class="toc-text">JSON 与 Array，List 转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-%E8%BD%AC%E6%8D%A2-Array"><span class="toc-text">JSON 转换 Array</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON-%E8%BD%AC%E6%8D%A2-List"><span class="toc-text">JSON 转换 List</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gson%E8%BF%9B%E9%98%B6%E7%94%A8%E6%B3%95"><span class="toc-text">Gson进阶用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%AF%B9%E8%B1%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">泛型对象反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">自定义序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-text">自定义反序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gson%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3"><span class="toc-text">Gson常用注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Expose"><span class="toc-text">@Expose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Since"><span class="toc-text">@Since</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SerializedName"><span class="toc-text">@SerializedName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JsonAdapter"><span class="toc-text">@JsonAdapter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-text">结语</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></li></ol></li></ol></div></div></div>

    
  
</div>


    </aside>
    <div class="l_main">
      

      


  <div class="bread-nav fs12">
  
    
    <div id="breadcrumb">
      <a class="cap breadcrumb" href="/">主页</a>
      <span class="sep"></span>
      <a class="cap breadcrumb" href="/">文章</a>
      
        <span class="sep"></span>
        <a class="cap breadcrumb-link" href="/categories/%E7%AC%94%E8%AE%B0%E6%9C%AC/">笔记本</a>
      
    </div>
    <div id="post-meta">
      发布于&nbsp;<time datetime="2019-09-18T12:32:30.000Z">2019-09-18</time>
    </div>
  
  </div>


<article class="content md post">
<h1 class="article-title"><span>Gson简易指南</span></h1>
<h2 id="Gson简介"><a href="#Gson简介" class="headerlink" title="Gson简介"></a>Gson简介</h2><p>在正式介绍 Gson 之前，我们可以先从<a href="https://link.juejin.im/?target=https://github.com/google/gson/blob/master/UserGuide.md%23TOC-Overview" rel="external nofollow noopener noreferrer" target="_blank">官方的wiki</a>看下 Gson 的描述，了解它是什么？</p>
<blockquote>
<p>Gson is a Java library that can be used to convert Java Objects into their JSON representation. It can also be used to convert a JSON string to an equivalent Java object。</p>
</blockquote>
<p>从描述可以看出，Gson 是用于将 Java 对象与 JSON格式字符串数据相互转换的 Java 库。它起初在Google 内部广泛使用在 Android 平台 和 Java 服务端上。2008 年开源之后，成为了谷歌又一个被广泛使用的开源框架，截止目前*(2019.09.08)* 在GitHub 上已有1W6 多星，相同作用的类库还有 Spring Framework 中集成的 Jackson，以及阿里开源的 fastjson等。</p>
<p>在特性方面，Gson 提供简易的API <code>fromJson/toJson</code> 来实现 Java 与 JSON 之间的转换，并且能生成紧凑，可读的 JSON 字符串输出，还支持复杂对象转换和丰富的自定义表示，足以满足在日常开发中我们绝大部分的 JSON 数据处理需求。</p>
<blockquote>
<p>通常将对象与JSON字符串间的转换称之为序列化和反序列化(Serialization/Deserialization)。将 对象转化成 JSON字符串的过程称为序列化，将JSON 字符串转化成对象的过程称为反序列化。</p>
</blockquote>
<h2 id="Gson基本使用"><a href="#Gson基本使用" class="headerlink" title="Gson基本使用"></a>Gson基本使用</h2><p>使用 Gson 框架进行序列化与反序列操作，都离不开 <code>com.google.gson.Gson</code> 对象，它也是 Gson 框架的关键对象，提供的公共 API 具备了多种序列化和反序列方式。</p>
<p>Gson 对象的创建主要有两种方式：</p>
<ul>
<li>使用 <strong>new</strong> 关键字直接创建：<code>Gson gson = new Gson()</code></li>
<li>由 <code>GsonBuilder</code> 对象构建：<code>Gson gson = new GsonBuilder().create()</code></li>
</ul>
<p>通常情况下，上面两种方式创建的 Gson 对象在进行序列化与反序列操作时行为都是一样的，但是第二种方式构建 Gson 对象时，允许进行额外的行为定制，比如格式化 JSON 字符串的输出内容，是否序列化 <strong>null</strong> 值等等。</p>
<h3 id="Java序列化"><a href="#Java序列化" class="headerlink" title="Java序列化"></a>Java序列化</h3><h4 id="简单对象的序列化"><a href="#简单对象的序列化" class="headerlink" title="简单对象的序列化"></a>简单对象的序列化</h4><p>通过下面的例子来看下通过上述两种方式序列化 Java 对象的不同效果：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">test_serialization</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">        Result result = <span class="keyword">new</span> Result(<span class="number">200</span>, <span class="string">&quot;成功&quot;</span>, <span class="keyword">null</span>);</span><br><span class="line">        String json = gson.toJson(result);</span><br><span class="line">        System.out.println(<span class="string">&quot;json is &quot;</span> + json);</span><br><span class="line">      </span><br><span class="line">        Gson buildedGson = <span class="keyword">new</span> GsonBuilder().setPrettyPrinting().serializeNulls().create();</span><br><span class="line">        String buildedJson = buildedGson.toJson(result);</span><br><span class="line">        System.out.println(<span class="string">&quot;buildedJson is &quot;</span> + buildedJson);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Result</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">        <span class="keyword">private</span> String message;</span><br><span class="line">        <span class="keyword">private</span> Object data;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Result</span><span class="params">(<span class="keyword">int</span> code, String message, Object data)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.code = code;</span><br><span class="line">            <span class="keyword">this</span>.message = message;</span><br><span class="line">            <span class="keyword">this</span>.data = data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从结果可以看出，默认的 Gson 对象行为序列化对象时会将 <code>null</code> 值的字段忽略，而 <code>com.google.gson.GsonBuilder#serializeNulls</code> 方法将允许 Gson 对象序列化 <code>null</code> 字段；并且正常序列化后的 JSON 字符串是紧凑格式，节省字符串内存，使用 <code>com.google.gson.GsonBuilder#setPrettyPrinting</code> 方法之后最终输出的 JSON 字符串是更易读的格式。当然除了这两个方法，GsonBuilder 还提供了许多定制序列化和反序列化行为的API。</p>
<h4 id="JosnObject-生成-JSON"><a href="#JosnObject-生成-JSON" class="headerlink" title="JosnObject 生成 JSON"></a>JosnObject 生成 JSON</h4><p>除了上述将自定义类的对象转换成 JSON 的方式之外，还可以使用 Gson 框架提供的 JsonObject 构建普通对象，然后使用 <code>toJson</code> 方法生成 JSON 字符串，在原测试类中补充下方测试类：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_jsonObject_serialization</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">  JsonObject jsonObject = <span class="keyword">new</span> JsonObject();</span><br><span class="line">  jsonObject.addProperty(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">  jsonObject.addProperty(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;参数错误&quot;</span>);</span><br><span class="line">  String toJson = gson.toJson(jsonObject);</span><br><span class="line">  String exceptedJson = <span class="string">&quot;&#123;\&quot;code\&quot;:400,\&quot;message\&quot;:\&quot;参数错误\&quot;&#125;&quot;</span>;</span><br><span class="line">  Assertions.assertEquals(exceptedJson, toJson); <span class="comment">//true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JsonObject 使用 <code>addProperty(property,value)</code> 方法只能用来添加 String，Number，Boolean，Character这四类数据， 因为内部是调用 <code>com.google.gson.JsonObject#add</code>, 将 value 封装成了 JsonPrimitive 对象，然后保存到了内部自定义的 <code>LinkedTreeMap</code> 集合变量 members 中；如果需要在 JsonObject 对象上添加其他对象时，就需要直接使用 <code>add(String property, JsonElement value)</code> 方法添加一个 JsonElement 对象。这里的 JsonElement 是一个抽象类，JsonObject 和 JsonPrimitive 都继承了JsonElement，所以我们最终通过另外的 JsonObject 对象来作为原 JsonObject 上的属性对象：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">JsonObject jsonObject = <span class="keyword">new</span> JsonObject();</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">JsonObject nestJsonObject = <span class="keyword">new</span> JsonObject();</span><br><span class="line">nestJsonObject.addProperty(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;one&quot;</span>);</span><br><span class="line">nestJsonObject.addProperty(<span class="string">&quot;score&quot;</span>, <span class="number">99</span>);</span><br><span class="line">jsonObject.add(<span class="string">&quot;data&quot;</span>, nestJsonObject);</span><br><span class="line">String toJson2 = gson.toJson(jsonObject);</span><br><span class="line">System.out.println(toJson2);</span><br><span class="line"><span class="comment">// &#123;&quot;code&quot;:400,&quot;message&quot;:&quot;参数错误&quot;,&quot;data&quot;:&#123;&quot;username&quot;:&quot;one&quot;,&quot;score&quot;:99&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="JSON-反序列化"><a href="#JSON-反序列化" class="headerlink" title="JSON 反序列化"></a>JSON 反序列化</h3><h4 id="简单对象的反序列化"><a href="#简单对象的反序列化" class="headerlink" title="简单对象的反序列化"></a>简单对象的反序列化</h4><p>现在我们再来看下 JSON 反序列化成 Java 对象用法，这里主要使用方法是 <code>com.google.gson.Gson#fromJson</code>，它最基础的用法就是 <code>fromJson(String json, Class&lt;T&gt; classOfT)</code>，尝试将 JSON 字符串转为指定 Class 的对象，如果转换失败，就会抛出 <code>JsonSyntaxException</code> 异常。我们可以在原来代码上新增一个测试用例，运行看下效果：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_deserialization</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String json = <span class="string">&quot;&#123;\&quot;code\&quot;:400,\&quot;message\&quot;:\&quot;参数错误\&quot;&#125;&quot;</span>;</span><br><span class="line">    Result result = <span class="keyword">new</span> Gson().fromJson(json, Result.class);</span><br><span class="line">    Assertions.assertEquals(<span class="number">400</span>, result.code); <span class="comment">// true</span></span><br><span class="line">    Assertions.assertEquals(<span class="string">&quot;参数错误&quot;</span>, result.message); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="反序列化-Map"><a href="#反序列化-Map" class="headerlink" title="反序列化 Map"></a>反序列化 Map</h4><p>除了将JSON 字符串序列化为自定义的Java 对象之外，我们还可以转为 Map 集合，Gson 提供了对 Map 集合的转换，使用起来也十分简单：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_map</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String jsonString = <span class="string">&quot;&#123;&#x27;employee.name&#x27;:&#x27;one&#x27;,&#x27;employee.salary&#x27;:10&#125;&quot;</span>;</span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    Map map = gson.fromJson(jsonString, Map.class);</span><br><span class="line">    assertEquals(<span class="number">2</span>, map.size());</span><br><span class="line">		assertEquals(<span class="string">&quot;one&quot;</span>, map.get(<span class="string">&quot;employee.name&quot;</span>));</span><br><span class="line">    assertEquals(Double.class, map.get(<span class="string">&quot;employee.name&quot;</span>).getClass());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是转换后的 Map 对象真实类型并不是我们经常用的 HashMap，而是 Gson 自定义集合<code>LinkedTreeMap</code> ，它实现Map 接口来存储键值对，在新增和删除上实现上进行了优化，并且将存储键值对的顺序作为遍历顺序，也就是先存入的先被遍历到。除此之外，JSON 字符串里的数值型数据都会转转换为 Double 类型，而 <code>true/false</code> 数据被会被转换成 Boolean 类型，具体判断依据可以参考 <code>com.google.gson.internal.bind.ObjectTypeAdapter#read</code> 方法的实现。</p>
<h3 id="JSON-与-Array，List-转换"><a href="#JSON-与-Array，List-转换" class="headerlink" title="JSON 与 Array，List 转换"></a>JSON 与 Array，List 转换</h3><h4 id="JSON-转换-Array"><a href="#JSON-转换-Array" class="headerlink" title="JSON 转换 Array"></a>JSON 转换 Array</h4><p>当我们正对 JSON 数据进行数组转换时，类似普通对象转换的方式即可， <code>toJson</code> 方法直接使用转为 JSON 数据，<code>fromJson</code> 指定数组类型转换为对应类型的数组。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_array</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">  <span class="keyword">int</span>[] ints = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">  String[] strings = &#123;<span class="string">&quot;abc&quot;</span>, <span class="string">&quot;def&quot;</span>, <span class="string">&quot;ghi&quot;</span>&#125;;</span><br><span class="line">  String s = gson.toJson(ints);<span class="comment">// [1,2,3,4,5]</span></span><br><span class="line">  assertEquals(<span class="string">&quot;[1,2,3,4,5]&quot;</span>, s); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  String s1 = gson.toJson(strings);<span class="comment">// [&quot;abc&quot;, &quot;def&quot;, &quot;ghi&quot;]</span></span><br><span class="line">  assertEquals(<span class="string">&quot;[\&quot;abc\&quot;,\&quot;def\&quot;,\&quot;ghi\&quot;]&quot;</span>, s1);</span><br><span class="line">  String[] strings1 = gson.fromJson(s1, String[].class);</span><br><span class="line">  assertEquals(strings.length, strings1.length); <span class="comment">// true</span></span><br><span class="line">  assertEquals(strings[<span class="number">0</span>], strings1[<span class="number">0</span>]); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span>[] ints2 = gson.fromJson(<span class="string">&quot;[1,2,3,4,5]&quot;</span>, <span class="keyword">int</span>[].class);</span><br><span class="line">  assertEquals(<span class="number">1</span>, ints2[<span class="number">0</span>]); <span class="comment">// true</span></span><br><span class="line">  assertEquals(<span class="number">5</span>, ints2[<span class="number">4</span>]); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="JSON-转换-List"><a href="#JSON-转换-List" class="headerlink" title="JSON 转换 List"></a>JSON 转换 List</h4><p>要将 List 数据转换为 JSON数据，使用 Gson 的方式与处理 Array 数据一样；这里主要讲的是将JSON 数据转为 List 对象的操作略有不同，要将一个 JSON 数组数据转换为一个自定义类的List 时，我们按照原来的写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">givenJsonString_whenIncorrectDeserializing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">    String inputString = <span class="string">&quot;[&#123;\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;one\&quot;&#125;,&#123;\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;two\&quot;&#125;]&quot;</span>;</span><br><span class="line">    List&lt;Person&gt; outputList = gson.fromJson(inputString, List.class);</span><br><span class="line">		outputList.get(<span class="number">0</span>).getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是不幸的是，运行这段代码后会抛出 <code>ClassCastException</code> 异常，具体描述如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.lang.ClassCastException: com.google.gson.internal.LinkedTreeMap cannot be cast to com.one.learn.Person</span><br></pre></td></tr></table></figure>

<p>从上述描述中我们可以知道执行 <code>fromJson</code> 之后，反序列化后得到的 List 元素类型为 LinkedTreeMap，而不是 Person，所以以 Person 对象方式访问 id 属性时就会抛出 <code>ClassCastException</code> 异常。那又该如何处理呢,   我们需要调用 Gson 的 另外一个 <code>fromJson</code> 方法：<code>fromJson(String json, Type typeOfT)</code> ，先看下使用方式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">givenJsonString_whenCorrectDeserializing_</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">  String inputString = <span class="string">&quot;[&#123;\&quot;id\&quot;:1,\&quot;name\&quot;:\&quot;one\&quot;&#125;,&#123;\&quot;id\&quot;:2,\&quot;name\&quot;:\&quot;two\&quot;&#125;]&quot;</span>;</span><br><span class="line">  Type type = <span class="keyword">new</span> TypeToken&lt;List&lt;Person&gt;&gt;()&#123;&#125;.getType();</span><br><span class="line">  List&lt;Person&gt; outputList = gson.fromJson(inputString, type);</span><br><span class="line">  <span class="keyword">int</span> id = outputList.get(<span class="number">0</span>).getId();</span><br><span class="line">  assertEquals(<span class="number">1</span>, id); <span class="comment">// true</span></span><br><span class="line">  assertEquals(<span class="string">&quot;one&quot;</span>, outputList.get(<span class="number">0</span>).getName()); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法中的 Type 对象通过 TypeToken 对象的 <code>getType</code> 方法获取到，就是 TypeToken 对象所关联的泛型类型。而这里 TypeToken 是 Gson 为了支持泛型而引入的类，来解决 Java 无法提供泛型类型表示的问题，由于 TypeToken 的构造方法是<code>protected</code>修饰的，无法直接构造，使用就需要写成<code>new TypeToken&lt;List&lt;String&gt;&gt;() &#123;&#125;.getType()</code>  形式。</p>
<h2 id="Gson进阶用法"><a href="#Gson进阶用法" class="headerlink" title="Gson进阶用法"></a>Gson进阶用法</h2><p>接触了 Gson 基本的使用之后，我们接着进一步学习 Gson 的其他用法。</p>
<h3 id="泛型对象反序列化"><a href="#泛型对象反序列化" class="headerlink" title="泛型对象反序列化"></a>泛型对象反序列化</h3><p>简单接触了 Gson 对泛型的支持，接下来用代码来展示下它的强大之处，首先我们将上文的 Result 类调整下接受泛型参数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Result</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">  <span class="keyword">private</span> String message;</span><br><span class="line">  <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">Result</span><span class="params">(<span class="keyword">int</span> code, String message, T data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.code = code;</span><br><span class="line">    <span class="keyword">this</span>.message = message;</span><br><span class="line">    <span class="keyword">this</span>.data = data;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后对一个有内嵌对象的 JSON字符串进行解析成 Result<user> 对象，示例代码如下：</user></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_genric_object</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  String json = <span class="string">&quot;&#123;\&quot;code\&quot;:200,\&quot;message\&quot;:\&quot;操作成功\&quot;,\&quot;data\&quot;:&#123;\&quot;username\&quot;: \&quot;one\&quot;,\&quot;avater\&quot;: \&quot;image.jpg\&quot;&quot;</span> +</span><br><span class="line">    <span class="string">&quot;&#125;&#125;&quot;</span>;</span><br><span class="line">  Type type = <span class="keyword">new</span> TypeToken&lt;Result&lt;User&gt;&gt;()&#123;&#125;.getType();</span><br><span class="line">  Result&lt;User&gt; result = <span class="keyword">new</span> Gson().fromJson(json, type);</span><br><span class="line">  Assertions.assertEquals(<span class="number">200</span>, result.code);</span><br><span class="line">  Assertions.assertEquals(<span class="string">&quot;one&quot;</span>, result.data.getUsername());</span><br><span class="line">  Assertions.assertEquals(<span class="string">&quot;image.jpg&quot;</span>, result.data.getAvater());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String username;</span><br><span class="line">  <span class="keyword">private</span> String avater;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> username;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getAvater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> avater;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用 TypeToken 对象获取具体泛型类型 Result<user> , 然后在 <code>fromJson</code> 方法中传入就会根据对应类型的执行反序列化操作。</user></p>
<h3 id="自定义序列化"><a href="#自定义序列化" class="headerlink" title="自定义序列化"></a>自定义序列化</h3><p>要对Java 对象的某些字段进行特殊处理，比如隐藏某些字段的序列化，对字段的数据格式化处理等，我们可以通过实现 JsonSerializer 接口，对序列化逻辑进行自定义。例如，我们需要对 Date 类型属性进行特定格式的处理，可以声明 DateSerializer 类实现如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DateSerializer</span> <span class="keyword">implements</span> <span class="title">JsonSerializer</span>&lt;<span class="title">Date</span>&gt; </span>&#123;</span><br><span class="line">    SimpleDateFormat dateTime = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JsonElement <span class="title">serialize</span><span class="params">(Date src, Type typeOfSrc, </span></span></span><br><span class="line"><span class="function"><span class="params">                                 JsonSerializationContext context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JsonPrimitive(dateTime.format(src));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在构建 Gson 对象前，利用 GsonBuilder 将 DateSerializer 实例进行注册，使用方式如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .registerTypeAdapter(Date.class, <span class="keyword">new</span> DateSerializer())</span><br><span class="line">    .create();</span><br></pre></td></tr></table></figure>

<p>这样一来，一旦遇到要序列化 Date 类型的字段时，都会通过自定义的 <code>serialize</code> 方法将日期以 <code>yyyy-MM-dd</code> 格式进行输出，如下方的示例代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_dateSerializer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  MyObject myObject = <span class="keyword">new</span> MyObject(<span class="keyword">new</span> Date(), <span class="string">&quot;one&quot;</span>);</span><br><span class="line">  Gson gson = <span class="keyword">new</span> GsonBuilder().registerTypeAdapter(Date.class, <span class="keyword">new</span> DateSerializer()).create();</span><br><span class="line">  String json = gson.toJson(myObject);</span><br><span class="line">  String exceptedJson = <span class="string">&quot;&#123;\&quot;date\&quot;:\&quot;2019-09-08\&quot;,\&quot;name\&quot;:\&quot;one\&quot;&#125;&quot;</span>;</span><br><span class="line">  Assertions.assertEquals(exceptedJson, json); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Date date;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyObject</span><span class="params">(Date date, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.date = date;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义反序列化"><a href="#自定义反序列化" class="headerlink" title="自定义反序列化"></a>自定义反序列化</h3><p>与自定义序列化实现方式类似，想要自定义反序列化逻辑，就需要同样要实现一个叫 JsonDeserializer 的接口，进行自定义反序列化逻辑的实现。比如现在有个 JSON 字符串内容为 <code>&#123;&quot;CODE&quot;: 400, &quot;MESSAGE&quot;: &quot;参数错误&quot;&#125;</code>，需要被反序列化为前文提到的 Result 对象，由于字段名不一样，为了实现对应的转换，就需要自定义 ResultDeserializer 类，具体实现如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultDeserializer</span> <span class="keyword">implements</span> <span class="title">JsonDeserializer</span>&lt;<span class="title">Result</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">deserialize</span><span class="params">(JsonElement json, </span></span></span><br><span class="line"><span class="function"><span class="params">                              Type typeOfT, </span></span></span><br><span class="line"><span class="function"><span class="params">                              JsonDeserializationContext context)</span> <span class="keyword">throws</span> JsonParseException </span>&#123;</span><br><span class="line">        JsonObject object = json.getAsJsonObject();</span><br><span class="line">        Result&lt;Object&gt; result = <span class="keyword">new</span> Result&lt;&gt;(object.getAsJsonPrimitive(<span class="string">&quot;CODE&quot;</span>)</span><br><span class="line">                                             .getAsInt(),</span><br><span class="line">                                             object.getAsJsonPrimitive(<span class="string">&quot;MESSAGE&quot;</span>)</span><br><span class="line">                                             .getAsString(), <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来就是利用 GsonBuilder 注册 ResultDeserializer 实例，生成对应的 Gson 对象，并进行反序列化操作：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_resultDeserializer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//language=JSON</span></span><br><span class="line">		String json = <span class="string">&quot;&#123;\&quot;CODE\&quot;: 400,\&quot;MESSAGE\&quot;: \&quot;参数错误\&quot;&#125;&quot;</span>;</span><br><span class="line">    Gson gson = <span class="keyword">new</span> GsonBuilder().registerTypeAdapter(Result.class, <span class="keyword">new</span> ResultDeserializer())</span><br><span class="line">            .create();</span><br><span class="line">    Result result = gson.fromJson(json, Result.class);</span><br><span class="line">    Assertions.assertEquals(<span class="number">400</span>, result.code); <span class="comment">// true</span></span><br><span class="line">    Assertions.assertEquals(<span class="string">&quot;参数错误&quot;</span>, result.message); <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Gson常用注解"><a href="#Gson常用注解" class="headerlink" title="Gson常用注解"></a>Gson常用注解</h2><p>Gson 除了提供一些 API 供开发者使用之外，还有一些具有特性的注解可以使用，接下来就介绍在 Gson 中最常用的注解。</p>
<h3 id="Expose"><a href="#Expose" class="headerlink" title="@Expose"></a>@Expose</h3><p>这个注解只能用在字段上，作用就是注明对应的字段是否将在序列化或者反序列化时暴露出来，有两个属性 <code>serialize</code> 和 <code>deserialize</code> ，默认都为 true。当给一个字段加上 注解<code>@Expose(serialize = true, deserialize = false)</code>，则表示了该字段尽在序列化时可见，在反序列化时会忽略赋值。需要额外注意的一点是，@Expose 注解只有在用 GsonBuilder 方式构建 Gson 时有限，并且构建前必须调用 <code>excludeFieldsWithoutExposeAnnotation</code> 方法，下面是具体的使用示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_expose</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MySubClass subclass = <span class="keyword">new</span> MySubClass(<span class="number">42L</span>, <span class="string">&quot;the answer&quot;</span>, <span class="string">&quot;Verbose field not to serialize&quot;</span>);</span><br><span class="line">    MyClass source = <span class="keyword">new</span> MyClass(<span class="number">1L</span>, <span class="string">&quot;foo&quot;</span>, <span class="string">&quot;bar&quot;</span>, subclass);</span><br><span class="line">    Gson gson = <span class="keyword">new</span> GsonBuilder().excludeFieldsWithoutExposeAnnotation().create();</span><br><span class="line">    String s = gson.toJson(source);</span><br><span class="line">    System.out.println(s);</span><br><span class="line">		<span class="comment">// &#123;&quot;id&quot;:1,&quot;name&quot;:&quot;foo&quot;,&quot;subclass&quot;:&#123;&quot;id&quot;:42,&quot;description&quot;:&quot;the answer&quot;,&quot;otherVerboseInfo&quot;:&quot;Verbose field not to serialize&quot;&#125;&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="meta">@Expose(serialize = false, deserialize = true)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> String other;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> MySubClass subclass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySubClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> id;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String otherVerboseInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在 Gson 中 <code>transient</code> 关键字修饰的字段默认不会被序列化和反序列化，这个行为是与 Java 原生的序列化和反序列化操作一致的。</p>
</blockquote>
<h3 id="Since"><a href="#Since" class="headerlink" title="@Since"></a>@Since</h3><p>该注解用于标记对应字段或者类型的版本，让 Gson 可以指定版本号进行序列化和反序列化操作。当Web服务上的 JSON 数据对应的类存在多个版本的字段时，这个注解就十分有用。</p>
<p>同样地，该注解只针对使用 <code>GsonBuilder</code> 方式构建的 Gson 对象，并且使用 <code>setVersion</code> 方法指明版本号时有效，只解析对象中对应版本的字段，下面为具体示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VersioningSupportTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        VersionedClass versionedObject = <span class="keyword">new</span> VersionedClass();</span><br><span class="line">        Gson gson = <span class="keyword">new</span> GsonBuilder().setVersion(<span class="number">1.0</span>).create();</span><br><span class="line">        String jsonOutput = gson.toJson(versionedObject);</span><br><span class="line">        System.out.println(jsonOutput); <span class="comment">// &#123;&quot;newField&quot;:&quot;new&quot;,&quot;field&quot;:&quot;old&quot;&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VersionedClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Since(1.1)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String newerField;</span><br><span class="line">    <span class="meta">@Since(1.0)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String newField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String field;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VersionedClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.newerField = <span class="string">&quot;newer&quot;</span>;</span><br><span class="line">        <span class="keyword">this</span>.newField = <span class="string">&quot;new&quot;</span>;</span><br><span class="line">        <span class="keyword">this</span>.field = <span class="string">&quot;old&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="SerializedName"><a href="#SerializedName" class="headerlink" title="@SerializedName"></a>@SerializedName</h3><p>这个注解使用起来比较简单，也很有用。@SerializedName 指定了成员字段被序列化和反序列化时所采用的名称下面是具体使用方式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JSONFieldNamingSupportTest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeObject</span> </span>&#123;</span><br><span class="line">        <span class="meta">@SerializedName(&quot;custom_naming&quot;)</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String someField;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> String someOtherField;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">SomeObject</span><span class="params">(String a, String b)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.someField = a;</span><br><span class="line">            <span class="keyword">this</span>.someOtherField = b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SomeObject someObject = <span class="keyword">new</span> SomeObject(<span class="string">&quot;first&quot;</span>, <span class="string">&quot;second&quot;</span>);</span><br><span class="line">        String jsonRepresentation = gson.toJson(someObject);</span><br><span class="line">        System.out.println(jsonRepresentation);</span><br><span class="line">      	<span class="comment">// &#123;&quot;custom_naming&quot;:&quot;first&quot;,&quot;someOtherField&quot;:&quot;second&quot;&#125;</span></span><br><span class="line">        SomeObject someObject1 = gson.fromJson(jsonRepresentation, SomeObject.class);</span><br><span class="line">        System.out.println(someObject1);</span><br><span class="line">      	<span class="comment">// SomeObject&#123;someField=&#x27;first&#x27;, someOtherField=&#x27;second&#x27;&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="JsonAdapter"><a href="#JsonAdapter" class="headerlink" title="@JsonAdapter"></a>@JsonAdapter</h3><p><code>@JsonAdapter</code> 主要作用就是代替  <code>GsonBuilder.registerTypeAdapter</code> 方法的执行，直接通过 <code>@JsonAdapter(aClass.class)</code> 方式指定 JsonDeserializer 对象或者 JsonSerializer 对象，可以起到相同的作用，并且优先级比<code>GsonBuilder.registerTypeAdapter</code>的优先级更高，由于只是将 <code>registerTypeAdapter</code>方法执行简化成了注解方法，这里就不再演示，直接在前文<strong>自定义反序列化</strong>一节的 Result 类上使用就可以看到效果。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>^_^.</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://juejin.im/post/5d764dcc6fb9a06b130f4b2a#heading-0">除了FastJson,你还有选择: Gson简易指南</a></li>
</ul>


<div class="article-footer fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div></section></div>

</article>

<div class="related-wrap" id="read-next"><section class="header cap theme"><span>接下来阅读</span></section><section class="body"><div class="post-title h2"><a href="/post/4084397208/">SonarQube的安装与使用</a></div><div class="post-title fs14"><a href="/post/3135129110/">上一篇：RocketMQ相关流程图/原理图</a></div></section></div>


<div class="related-wrap" id="related-posts">
    <section class="header">
      <div class="title cap theme">您可能感兴趣的文章</div>
    </section>
    <section class="body">
    <div class="related-posts"><a class="item" href="/post/3136136825/" title="SpringBoot自动部署脚本"><div class="img"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/2021/04/14194816180355881618035588178.png"></div><span class="title">SpringBoot自动部署脚本</span></a><a class="item" href="/post/2348855541/" title="SpringBoot启动脚本"><div class="img"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/2021/04/14194816180355881618035588178.png"></div><span class="title">SpringBoot启动脚本</span></a><a class="item" href="/post/2878379624/" title="SpringBoot文件上传异常处理"><div class="img"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gitee.com/cayzlh/img-repo/raw/master/2021/02/10511616140486761614048676335.jpg"></div><span class="title">SpringBoot文件上传异常处理</span><span class="excerpt">SpringBoot文件上传异常处理：The temporary upload location xxx is not valid</span></a><a class="item" href="/post/1320718638/" title="记关于Consul的一点使用笔记"><div class="img"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/2021/04/14194816180355881618035588178.png"></div><span class="title">记关于Consul的一点使用笔记</span><span class="excerpt">记录一次使用Consul过程中遇到的坑以及解决办法</span></a><a class="item" href="/post/20210402/" title="HomeBrew换源"><div class="img"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://cdn.jsdelivr.net/gh/cayzlh/git-img-repository@master/2021/04/14194816180355881618035588178.png"></div><span class="title">HomeBrew换源</span></a></div></section></div>





      
<footer class="page-footer fs12" style="text-align: center;"><hr><div><p><a href="https://www.cayzlh.com/">🐳Ant丶</a> ©️ 2017-2021</p>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://beian.miit.gov.cn/">粤ICP备20058712号</a></p>
</div></footer>

      <div class="float-panel mobile-only" style="display:none">
  <button type="button" class="sidebar-toggle mobile" onclick="sidebar.toggle()">
    <svg class="icon" viewbox="0 0 1228 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2849"><path d="M0 0m97.390199 0l973.901995 0q97.390199 0 97.390199 97.390199l0 0q0 97.390199-97.390199 97.3902l-973.901995 0q-97.390199 0-97.390199-97.3902l0 0q0-97.390199 97.390199-97.390199Z" p-id="2850"/><path d="M0 389.560798m97.390199 0l973.901995 0q97.390199 0 97.390199 97.390199l0 0q0 97.390199-97.390199 97.3902l-973.901995 0q-97.390199 0-97.390199-97.3902l0 0q0-97.390199 97.390199-97.390199Z" p-id="2851"/><path d="M0 779.121596m97.390199 0l973.901995 0q97.390199 0 97.390199 97.390199l0 0q0 97.390199-97.390199 97.390199l-973.901995 0q-97.390199 0-97.390199-97.390199l0 0q0-97.390199 97.390199-97.390199Z" p-id="2852"/></svg>
  </button>
</div>

    </div>
  </div>
  <div class="scripts">
    <script type="text/javascript">
  stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script')
      script.src = src
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.1.0';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js',
    sitesjs: '/js/plugins/sites.js',
    friendsjs: '/js/plugins/friends.js',
  };

  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.3.1/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper/swiper-bundle.min.css","js":"https://unpkg.com/swiper/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://cdn.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
